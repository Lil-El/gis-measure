const I=[["(",")"],[")","("],["<",">"],[">","<"],["[","]"],["]","["],["{","}"],["}","{"],["«","»"],["»","«"],["‹","›"],["›","‹"],["⁽","⁾"],["⁾","⁽"],["₍","₎"],["₎","₍"],["≤","≥"],["≥","≤"],["〈","〉"],["〉","〈"],["﹙","﹚"],["﹚","﹙"],["﹛","﹜"],["﹜","﹛"],["﹝","﹞"],["﹞","﹝"],["﹤","﹥"],["﹥","﹤"]],E=["آ","أ","إ","ا"],$=["ﻵ","ﻷ","ﻹ","ﻻ"],tt=["ﻶ","ﻸ","ﻺ","ﻼ"],D=["ا","ب","ت","ث","ج","ح","خ","د","ذ","ر","ز","س","ش","ص","ض","ط","ظ","ع","غ","ف","ق","ك","ل","م","ن","ه","و","ي","إ","أ","آ","ة","ى","ل","م","ن","ه","و","ي","إ","أ","آ","ة","ى","ی","ئ","ؤ"],rt=["ﺍ","ﺏ","ﺕ","ﺙ","ﺝ","ﺡ","ﺥ","ﺩ","ﺫ","ﺭ","ﺯ","ﺱ","ﺵ","ﺹ","ﺽ","ﻁ","ﻅ","ﻉ","ﻍ","ﻑ","ﻕ","ﻙ","ﻝ","ﻡ","ﻥ","ﻩ","ﻭ","ﻱ","ﺇ","ﺃ","ﺁ","ﺓ","ﻯ","ﯼ","ﺉ","ﺅ","ﹰ","ﹲ","ﹴ","ﹶ","ﹸ","ﹺ","ﹼ","ﹾ","ﺀ","ﺉ","ﺅ"],et=["ﺎ","ﺐ","ﺖ","ﺚ","ﺞ","ﺢ","ﺦ","ﺪ","ﺬ","ﺮ","ﺰ","ﺲ","ﺶ","ﺺ","ﺾ","ﻂ","ﻆ","ﻊ","ﻎ","ﻒ","ﻖ","ﻚ","ﻞ","ﻢ","ﻦ","ﻪ","ﻮ","ﻲ","ﺈ","ﺄ","ﺂ","ﺔ","ﻰ","ﯽ","ﺊ","ﺆ","ﹰ","ﹲ","ﹴ","ﹶ","ﹸ","ﹺ","ﹼ","ﹾ","ﺀ","ﺊ","ﺆ"],nt=["ﺎ","ﺒ","ﺘ","ﺜ","ﺠ","ﺤ","ﺨ","ﺪ","ﺬ","ﺮ","ﺰ","ﺴ","ﺸ","ﺼ","ﻀ","ﻄ","ﻈ","ﻌ","ﻐ","ﻔ","ﻘ","ﻜ","ﻠ","ﻤ","ﻨ","ﻬ","ﻮ","ﻴ","ﺈ","ﺄ","ﺂ","ﺔ","ﻰ","ﯿ","ﺌ","ﺆ","ﹱ","ﹲ","ﹴ","ﹷ","ﹹ","ﹻ","ﹽ","ﹿ","ﺀ","ﺌ","ﺆ"],ut=["ﺍ","ﺑ","ﺗ","ﺛ","ﺟ","ﺣ","ﺧ","ﺩ","ﺫ","ﺭ","ﺯ","ﺳ","ﺷ","ﺻ","ﺿ","ﻃ","ﻇ","ﻋ","ﻏ","ﻓ","ﻗ","ﻛ","ﻟ","ﻣ","ﻧ","ﻫ","ﻭ","ﻳ","ﺇ","ﺃ","ﺁ","ﺓ","ﻯ","ﯾ","ﺋ","ﺅ","ﹰ","ﹲ","ﹴ","ﹶ","ﹸ","ﹺ","ﹼ","ﹾ","ﺀ","ﺋ","ﺅ"],z=["ء","آ","أ","ؤ","إ","ا","ة","د","ذ","ر","ز","و","ى"],st=["ً","ً","ٌ","؟","ٍ","؟","َ","َ","ُ","ُ","ِ","ِ","ّ","ّ","ْ","ْ","ء","آ","آ","أ","أ","ؤ","ؤ","إ","إ","ئ","ئ","ئ","ئ","ا","ا","ب","ب","ب","ب","ة","ة","ت","ت","ت","ت","ث","ث","ث","ث","ج","ج","ج","ج","ح","ح","ح","ح","خ","خ","خ","خ","د","د","ذ","ذ","ر","ر","ز","ز","س","س","س","س","ش","ش","ش","ش","ص","ص","ص","ص","ض","ض","ض","ض","ط","ط","ط","ط","ظ","ظ","ظ","ظ","ع","ع","ع","ع","غ","غ","غ","غ","ف","ف","ف","ف","ق","ق","ق","ق","ك","ك","ك","ك","ل","ل","ل","ل","م","م","م","م","ن","ن","ن","ن","ه","ه","ه","ه","و","و","ى","ى","ي","ي","ي","ي","ﻵ","ﻶ","ﻷ","ﻸ","ﻹ","ﻺ","ﻻ","ﻼ","؟","؟","؟"],q=["ء","ف"],ot=["غ","ي"],it=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],at=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],e=0,o=1,h=2,d=3,t=4,p=5,j=6,r=7,m=8,R=9,b=10,T=11,n=12,ft=13,lt=14,ct=15,ht=16,Tt=17,c=18,At=["UBAT_L","UBAT_R","UBAT_EN","UBAT_AN","UBAT_ON","UBAT_B","UBAT_S","UBAT_AL","UBAT_WS","UBAT_CS","UBAT_ES","UBAT_ET","UBAT_NSM","UBAT_LRE","UBAT_RLE","UBAT_PDF","UBAT_LRO","UBAT_RLO","UBAT_BN"],_=100,Lt=[_+0,e,e,e,e,_+1,_+2,_+3,o,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,_+4,t,t,t,e,t,e,t,e,t,t,t,e,e,t,t,e,e,e,e,e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e,e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e,e,t,t,e,e,t,t,e,e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e,e,e,_+5,r,r,_+6,_+7],gt=[[c,c,c,c,c,c,c,c,c,j,p,j,m,p,c,c,c,c,c,c,c,c,c,c,c,c,c,c,p,p,p,j,m,t,t,T,T,T,t,t,t,t,t,b,R,b,R,R,h,h,h,h,h,h,h,h,h,h,R,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,c,c,c,c,c,c,p,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,R,t,T,T,T,T,t,t,t,t,e,t,t,c,t,t,T,T,h,h,t,e,t,t,t,h,e,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,e,e,e,e,e,e,e,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,e,t,t,t,t,t,t,t,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,o,n,o,n,n,o,n,n,o,n,t,t,t,t,t,t,t,t,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,t,t,t,t,t,o,o,o,o,o,t,t,t,t,t,t,t,t,t,t,t],[d,d,d,d,t,t,t,t,r,T,T,r,R,r,t,t,n,n,n,n,n,n,n,n,n,n,n,r,t,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,d,d,d,d,d,d,d,d,d,d,T,d,d,r,r,r,n,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,n,n,n,n,n,n,n,d,t,n,n,n,n,n,n,r,r,n,n,t,n,n,n,n,r,r,h,h,h,h,h,h,h,h,h,h,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,t,r,r,n,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,t,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,n,n,n,n,n,n,n,n,n,n,n,r,t,t,t,t,t,t,t,t,t,t,t,t,t,t,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,n,n,n,n,n,n,n,n,n,o,o,t,t,t,t,o,t,t,t,t,t],[m,m,m,m,m,m,m,m,m,m,m,c,c,c,e,o,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,m,p,ft,lt,ct,ht,Tt,R,T,T,T,T,T,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,R,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,m,c,c,c,c,c,t,t,t,t,t,c,c,c,c,c,c,h,e,t,t,h,h,h,h,h,h,b,b,t,t,t,e,h,h,h,h,h,h,h,h,h,h,b,b,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[e,e,e,e,e,e,e,t,t,t,t,t,t,t,t,t,t,t,t,e,e,e,e,e,t,t,t,t,t,o,n,o,o,o,o,o,o,o,o,o,o,b,o,o,o,o,o,o,o,o,o,o,o,o,o,t,o,o,o,o,o,t,o,t,o,o,t,o,o,t,o,o,o,o,o,o,o,o,o,o,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,n,n,n,n,n,n,n,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,R,t,R,t,t,R,t,t,t,t,t,t,t,t,t,T,t,t,b,b,t,t,t,t,t,T,T,t,t,t,t,t,r,r,r,r,r,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,t,t,c],[t,t,t,T,T,T,t,t,t,t,t,b,R,b,R,R,h,h,h,h,h,h,h,h,h,h,R,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,e,e,e,e,e,e,t,t,e,e,e,e,e,e,t,t,e,e,e,e,e,e,t,t,e,e,e,t,t,t,T,T,t,t,t,T,T,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t]];class Pt{constructor(){this.inputFormat="ILYNN",this.outputFormat="VLNNN",this.sourceToTarget=[],this.targetToSource=[],this.levels=[]}bidiTransform(u,i,a){if(this.sourceToTarget=[],this.targetToSource=[],!u)return"";if(Ot(this.sourceToTarget,this.targetToSource,u.length),!this.checkParameters(i,a))return u;i=this.inputFormat,a=this.outputFormat;let f=u;const l=It,L=H(i.charAt(1)),A=H(a.charAt(1)),g=(i.charAt(0)==="I"?"L":i.charAt(0))+L,U=(a.charAt(0)==="I"?"L":a.charAt(0))+A,B=i.charAt(2)+a.charAt(2);l.defInFormat=g,l.defOutFormat=U,l.defSwap=B;const w=V(u,g,U,B,l);let N=!1;return a.charAt(1)==="R"?N=!0:a.charAt(1)!=="C"&&a.charAt(1)!=="D"||(N=this.checkContextual(w)==="rtl"),this.sourceToTarget=F,this.targetToSource=xt(this.sourceToTarget),P=this.targetToSource,f=i.charAt(3)===a.charAt(3)?w:a.charAt(3)==="S"?dt(N,w):Rt(w,N,!0),this.sourceToTarget=F,this.targetToSource=P,this.levels=y,f}_inputFormatSetter(u){if(!J.test(u))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=u}_outputFormatSetter(u){if(!J.test(u))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=u}checkParameters(u,i){return u?this._inputFormatSetter(u):u=this.inputFormat,i?this._outputFormatSetter(i):i=this.outputFormat,u!==i}checkContextual(u){let i=k(u);if(i!=="ltr"&&i!=="rtl"){try{i=document.dir.toLowerCase()}catch{}i!=="ltr"&&i!=="rtl"&&(i="ltr")}return i}hasBidiChar(u){return kt.test(u)}}function V(s,u,i,a,f){const l=Ut(s,{inFormat:u,outFormat:i,swap:a},f);if(l.inFormat===l.outFormat)return s;u=l.inFormat,i=l.outFormat,a=l.swap;const L=u.substring(0,1),A=u.substring(1,4),g=i.substring(0,1),U=i.substring(1,4);if(f.inFormat=u,f.outFormat=i,f.swap=a,L==="L"&&i==="VLTR"){if(A==="LTR")return f.dir=v,S(s,f);if(A==="RTL")return f.dir=O,S(s,f)}if(L==="V"&&g==="V")return f.dir=A==="RTL"?O:v,Y(s,f);if(L==="L"&&i==="VRTL")return A==="LTR"?(f.dir=v,s=S(s,f)):(f.dir=O,s=S(s,f)),Y(s);if(u==="VLTR"&&i==="LLTR")return f.dir=v,S(s,f);if(L==="V"&&g==="L"&&A!==U)return s=Y(s),A==="RTL"?V(s,"LLTR","VLTR",a,f):V(s,"LRTL","VRTL",a,f);if(u==="VRTL"&&i==="LRTL")return V(s,"LRTL","VRTL",a,f);if(L==="L"&&g==="L"){const B=f.swap;return f.swap=B.substr(0,1)+"N",A==="RTL"?(f.dir=O,s=S(s,f),f.swap="N"+B.substr(1,2),f.dir=v,s=S(s,f)):(f.dir=v,s=S(s,f),f.swap="N"+B.substr(1,2),s=V(s,"VLTR","LRTL",f.swap,f)),s}return s}function Ut(s,u,i){if(u.inFormat===void 0&&(u.inFormat=i.defInFormat),u.outFormat===void 0&&(u.outFormat=i.defOutFormat),u.swap===void 0&&(u.swap=i.defSwap),u.inFormat===u.outFormat)return u;const a=u.inFormat.substring(0,1),f=u.outFormat.substring(0,1);let l,L=u.inFormat.substring(1,4),A=u.outFormat.substring(1,4);return L.charAt(0)==="C"&&(l=k(s),L=l==="ltr"||l==="rtl"?l.toUpperCase():u.inFormat.charAt(2)==="L"?"LTR":"RTL",u.inFormat=a+L),A.charAt(0)==="C"&&(l=k(s),l==="rtl"?A="RTL":l==="ltr"?(l=mt(s),A=l.toUpperCase()):A=u.outFormat.charAt(2)==="L"?"LTR":"RTL",u.outFormat=f+A),u}function dt(s,u,i){if(u.length===0)return"";s===void 0&&(s=!0);const a=(u=String(u)).split("");let f=0,l=1,L=a.length;s||(f=a.length-1,l=-1,L=1);const A=Bt(a,f,l,L);let g="";for(let U=0;U<a.length;U++)pt(A,A.length,U)>-1?(X(P,U,!s,-1),F.splice(U,1)):g+=a[U];return g}function Bt(s,u,i,a,f){let l=0;const L=[];let A=0;for(let g=u;g*i<a;g+=i)if(Q(s[g])||x(s[g])){if(s[g]==="ل"&&St(s,g+i,i,a)){s[g]=Vt(s[g+i],l===0?$:tt),g+=i,Et(s,g,i,a),L[A]=g,A++,l=0;continue}const U=s[g];l===1?s[g]=Z(s,g+i,i,a)?vt(s[g]):W(s[g],et):Z(s,g+i,i,a)===!0?s[g]=W(s[g],ut):s[g]=W(s[g],rt),x(U)||(l=1),Ct(U)===!0&&(l=0)}else l=0;return L}function k(s){const u=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(s);return u?u[0]<="z"?"ltr":"rtl":""}function mt(s){const u=s.split("");return u.reverse(),k(u.join(""))}function Rt(s,u,i){if(s.length===0)return"";u===void 0&&(u=!0);let a="";const f=(s=String(s)).split("");for(let l=0;l<s.length;l++){let L=!1;if(f[l]>="ﹰ"&&f[l]<"\uFEFF"){const A=s.charCodeAt(l);f[l]>="ﻵ"&&f[l]<="ﻼ"?(u?(l>0&&i&&f[l-1]===" "?a=a.substring(0,a.length-1)+"ل":(a+="ل",L=!0),a+=E[(A-65269)/2]):(a+=E[(A-65269)/2],a+="ل",l+1<s.length&&i&&f[l+1]===" "?l++:L=!0),L&&(X(P,l,!0,1),F.splice(l,0,F[l]))):a+=st[A-65136]}else a+=f[l]}return a}function S(s,u){const i=s.split(""),a=[];return K(i,a,u),bt(i,a,u),G(2,i,a,u),G(1,i,a,u),y=a,i.join("")}function K(s,u,i){const a=s.length,f=i.dir?at:it;let l=0,L=-1;const A=[],g=[];i.hiLevel=i.dir,i.lastArabic=!1,i.hasUbatAl=!1,i.hasUbatB=!1,i.hasUbatS=!1;for(let U=0;U<a;U++)A[U]=_t(s[U]);for(let U=0;U<a;U++){const B=l,w=wt(s,A,g,U,i);g[U]=w,l=f[B][w];const N=240&l;l&=15;const M=f[l][jt];if(u[U]=M,N>0)if(N===16){for(let C=L;C<U;C++)u[C]=1;L=-1}else L=-1;if(f[l][Dt])L===-1&&(L=U);else if(L>-1){for(let C=L;C<U;C++)u[C]=M;L=-1}A[U]===p&&(u[U]=0),i.hiLevel|=M}i.hasUbatS&&Ft(A,u,a,i)}function Ft(s,u,i,a){for(let f=0;f<i;f++)if(s[f]===j){u[f]=a.dir;for(let l=f-1;l>=0&&s[l]===m;l--)u[l]=a.dir}}function bt(s,u,i){if(i.hiLevel!==0&&i.swap.substr(0,1)!==i.swap.substr(1,2))for(let a=0;a<s.length;a++)u[a]===1&&(s[a]=Nt(s[a]))}function _t(s){const u=s.charCodeAt(0),i=Lt[u>>8];return i<_?i:gt[i-_][255&u]}function Y(s,u){const i=s.split("");if(u){const a=[];K(i,a,u),y=a}return i.reverse(),F.reverse(),i.join("")}function pt(s,u,i){for(let a=0;a<u;a++)if(s[a]===i)return a;return-1}function Q(s){for(let u=0;u<q.length;u++)if(s>=q[u]&&s<=ot[u])return!0;return!1}function Z(s,u,i,a){for(;u*i<a&&x(s[u]);)u+=i;return!!(u*i<a&&Q(s[u]))}function St(s,u,i,a){for(;u*i<a&&x(s[u]);)u+=i;let f=" ";if(!(u*i<a))return!1;f=s[u];for(let l=0;l<E.length;l++)if(E[l]===f)return!0;return!1}function G(s,u,i,a){if(a.hiLevel<s)return;if(s===1&&a.dir===O&&!a.hasUbatB)return u.reverse(),void F.reverse();const f=u.length;let l,L,A,g,U,B=0;for(;B<f;){if(i[B]>=s){for(l=B+1;l<f&&i[l]>=s;)l++;for(L=B,A=l-1;L<A;L++,A--)g=u[L],u[L]=u[A],u[A]=g,U=F[L],F[L]=F[A],F[A]=U;B=l}B++}}function wt(s,u,i,a,f){const l=u[a];return{UBAT_L:()=>(f.lastArabic=!1,e),UBAT_R:()=>(f.lastArabic=!1,o),UBAT_ON:()=>t,UBAT_AN:()=>d,UBAT_EN:()=>f.lastArabic?d:h,UBAT_AL:()=>(f.lastArabic=!0,f.hasUbatAl=!0,o),UBAT_WS:()=>t,UBAT_CS:()=>{let L,A;return a<1||a+1>=u.length||(L=i[a-1])!==h&&L!==d||(A=u[a+1])!==h&&A!==d?t:(f.lastArabic&&(A=d),A===L?A:t)},UBAT_ES:()=>(a>0?i[a-1]:p)===h&&a+1<u.length&&u[a+1]===h?h:t,UBAT_ET:()=>{if(a>0&&i[a-1]===h)return h;if(f.lastArabic)return t;let L=a+1;const A=u.length;for(;L<A&&u[L]===T;)L++;return L<A&&u[L]===h?h:t},UBAT_NSM:()=>{if(f.inFormat==="VLTR"){const L=u.length;let A=a+1;for(;A<L&&u[A]===n;)A++;if(A<L){const g=s[a].charCodeAt(0),U=g>=1425&&g<=2303||g===64286,B=u[A];if(U&&(B===o||B===r))return o}}return a<1||u[a-1]===p?t:i[a-1]},UBAT_B:()=>(f.lastArabic=!0,f.hasUbatB=!0,f.dir),UBAT_S:()=>(f.hasUbatS=!0,t),UBAT_LRE:()=>(f.lastArabic=!1,t),UBAT_RLE:()=>(f.lastArabic=!1,t),UBAT_LRO:()=>(f.lastArabic=!1,t),UBAT_RLO:()=>(f.lastArabic=!1,t),UBAT_PDF:()=>(f.lastArabic=!1,t),UBAT_BN:()=>t}[At[l]]()}function Nt(s){let u,i=0,a=I.length-1;for(;i<=a;)if(u=Math.floor((i+a)/2),s<I[u][0])a=u-1;else{if(!(s>I[u][0]))return I[u][1];i=u+1}return s}function Ct(s){for(let u=0;u<z.length;u++)if(z[u]===s)return!0;return!1}function vt(s){for(let u=0;u<D.length;u++)if(s===D[u])return nt[u];return s}function W(s,u){for(let i=0;i<D.length;i++)if(s===D[i])return u[i];return s}function x(s){return s>="ً"&&s<="ٕ"}function H(s){return s==="L"?"LTR":s==="R"?"RTL":s==="C"?"CLR":s==="D"?"CRL":""}function Et(s,u,i,a){for(;u*i<a&&x(s[u]);)u+=i;return u*i<a&&(s[u]=" ",!0)}function Vt(s,u){for(let i=0;i<E.length;i++)if(s===E[i])return u[i];return s}function Ot(s,u,i){F=[],y=[];for(let a=0;a<i;a++)s[a]=a,u[a]=a,F[a]=a}function xt(s){const u=new Array(s.length);for(let i=0;i<s.length;i++)u[s[i]]=i;return u}function X(s,u,i,a){for(let f=0;f<s.length;f++)(s[f]>u||!i&&s[f]===u)&&(s[f]+=a)}let F=[],P=[],y=[];const It={dir:0,defInFormat:"LLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,defOutFormat:""},jt=5,Dt=6,v=0,O=1,J=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,kt=/[\u0591-\u06ff\ufb1d-\ufefc]/;export{Pt as C};
